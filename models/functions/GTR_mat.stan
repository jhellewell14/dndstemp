matrix build_GTR(real alpha, real beta, real gamma, 
real delta, real epsilon, real eta, matrix pimat, matrix pimult) {
  matrix[61, 61] M = rep_matrix(0.0, 61, 61);
  
  M[1,2] = eta;
  M[1,3] = gamma;
  M[1,4] = epsilon;
  M[1,5] = eta;
  M[1,9] = gamma;
  M[1,11] = epsilon;
  M[1,14] = eta;
  M[1,30] = gamma;
  M[1,46] = epsilon;
  M[2,1] = eta;
  M[2,3] = beta;
  M[2,4] = delta;
  M[2,6] = eta;
  M[2,10] = gamma;
  M[2,12] = epsilon;
  M[2,15] = eta;
  M[2,31] = gamma;
  M[2,47] = epsilon;
  M[3,1] = gamma;
  M[3,4] = alpha;
  M[3,7] = eta;
  M[3,16] = eta;
  M[3,32] = gamma;
  M[3,48] = epsilon;
  M[4,1] = epsilon;
  M[4,2] = delta;
  M[4,3] = alpha;
  M[4,8] = eta;
  M[4,13] = epsilon;
  M[4,17] = eta;
  M[4,33] = gamma;
  M[4,49] = epsilon;
  M[5,1] = eta;
  M[5,6] = eta;
  M[5,7] = gamma;
  M[5,8] = epsilon;
  M[5,9] = beta;
  M[5,11] = delta;
  M[5,18] = eta;
  M[5,34] = gamma;
  M[5,50] = epsilon;
  M[6,2] = eta;
  M[6,5] = eta;
  M[6,7] = beta;
  M[6,8] = delta;
  M[6,10] = beta;
  M[6,12] = delta;
  M[6,19] = eta;
  M[6,35] = gamma;
  M[6,51] = epsilon;
  M[7,3] = eta;
  M[7,5] = gamma;
  M[7,8] = alpha;
  M[7,20] = eta;
  M[7,36] = gamma;
  M[7,52] = epsilon;
  M[8,4] = eta;
  M[8,5] = epsilon;
  M[8,6] = delta;
  M[8,7] = alpha;
  M[8,13] = delta;
  M[8,21] = eta;
  M[8,37] = gamma;
  M[8,53] = epsilon;
  M[9,1] = gamma;
  M[9,10] = eta;
  M[9,11] = alpha;
  M[9,22] = eta;
  M[9,38] = gamma;
  M[9,54] = epsilon;
  M[10,2] = gamma;
  M[10,9] = eta;
  M[10,12] = alpha;
  M[10,23] = eta;
  M[10,39] = gamma;
  M[10,55] = epsilon;
  M[11,1] = epsilon;
  M[11,5] = delta;
  M[11,9] = alpha;
  M[11,12] = eta;
  M[11,13] = epsilon;
  M[11,26] = eta;
  M[11,42] = gamma;
  M[11,58] = epsilon;
  M[12,2] = epsilon;
  M[12,6] = delta;
  M[12,10] = alpha;
  M[12,11] = eta;
  M[12,13] = delta;
  M[12,27] = eta;
  M[12,43] = gamma;
  M[12,59] = epsilon;
  M[13,4] = epsilon;
  M[13,8] = delta;
  M[13,11] = epsilon;
  M[13,12] = delta;
  M[13,29] = eta;
  M[13,45] = gamma;
  M[13,61] = epsilon;
  M[14,1] = eta;
  M[14,15] = eta;
  M[14,16] = gamma;
  M[14,17] = epsilon;
  M[14,18] = eta;
  M[14,22] = gamma;
  M[14,26] = epsilon;
  M[14,30] = beta;
  M[14,46] = delta;
  M[15,2] = eta;
  M[15,14] = eta;
  M[15,16] = beta;
  M[15,17] = delta;
  M[15,19] = eta;
  M[15,23] = gamma;
  M[15,27] = epsilon;
  M[15,31] = beta;
  M[15,47] = delta;
  M[16,3] = eta;
  M[16,14] = gamma;
  M[16,17] = alpha;
  M[16,20] = eta;
  M[16,24] = gamma;
  M[16,28] = epsilon;
  M[16,32] = beta;
  M[16,48] = delta;
  M[17,4] = eta;
  M[17,14] = epsilon;
  M[17,15] = delta;
  M[17,16] = alpha;
  M[17,21] = eta;
  M[17,25] = gamma;
  M[17,29] = epsilon;
  M[17,33] = beta;
  M[17,49] = delta;
  M[18,5] = eta;
  M[18,14] = eta;
  M[18,19] = eta;
  M[18,20] = gamma;
  M[18,21] = epsilon;
  M[18,22] = beta;
  M[18,26] = delta;
  M[18,34] = beta;
  M[18,50] = delta;
  M[19,6] = eta;
  M[19,15] = eta;
  M[19,18] = eta;
  M[19,20] = beta;
  M[19,21] = delta;
  M[19,23] = beta;
  M[19,27] = delta;
  M[19,35] = beta;
  M[19,51] = delta;
  M[20,7] = eta;
  M[20,16] = eta;
  M[20,18] = gamma;
  M[20,21] = alpha;
  M[20,24] = beta;
  M[20,28] = delta;
  M[20,36] = beta;
  M[20,52] = delta;
  M[21,8] = eta;
  M[21,17] = eta;
  M[21,18] = epsilon;
  M[21,19] = delta;
  M[21,20] = alpha;
  M[21,25] = beta;
  M[21,29] = delta;
  M[21,37] = beta;
  M[21,53] = delta;
  M[22,9] = eta;
  M[22,14] = gamma;
  M[22,23] = eta;
  M[22,24] = gamma;
  M[22,25] = epsilon;
  M[22,26] = alpha;
  M[22,38] = beta;
  M[22,54] = delta;
  M[23,10] = eta;
  M[23,15] = gamma;
  M[23,22] = eta;
  M[23,24] = beta;
  M[23,25] = delta;
  M[23,27] = alpha;
  M[23,39] = beta;
  M[23,55] = delta;
  M[24,16] = gamma;
  M[24,22] = gamma;
  M[24,25] = alpha;
  M[24,28] = alpha;
  M[24,40] = beta;
  M[24,56] = delta;
  M[25,17] = gamma;
  M[25,22] = epsilon;
  M[25,23] = delta;
  M[25,24] = alpha;
  M[25,29] = alpha;
  M[25,41] = beta;
  M[25,57] = delta;
  M[26,11] = eta;
  M[26,14] = epsilon;
  M[26,18] = delta;
  M[26,22] = alpha;
  M[26,27] = eta;
  M[26,28] = gamma;
  M[26,29] = epsilon;
  M[26,42] = beta;
  M[26,58] = delta;
  M[27,12] = eta;
  M[27,15] = epsilon;
  M[27,19] = delta;
  M[27,23] = alpha;
  M[27,26] = eta;
  M[27,28] = beta;
  M[27,29] = delta;
  M[27,43] = beta;
  M[27,59] = delta;
  M[28,16] = epsilon;
  M[28,20] = delta;
  M[28,24] = alpha;
  M[28,26] = gamma;
  M[28,29] = alpha;
  M[28,44] = beta;
  M[28,60] = delta;
  M[29,13] = eta;
  M[29,17] = epsilon;
  M[29,21] = delta;
  M[29,25] = alpha;
  M[29,26] = epsilon;
  M[29,27] = delta;
  M[29,28] = alpha;
  M[29,45] = beta;
  M[29,61] = delta;
  M[30,1] = gamma;
  M[30,31] = eta;
  M[30,32] = gamma;
  M[30,33] = epsilon;
  M[30,34] = eta;
  M[30,38] = gamma;
  M[30,42] = epsilon;
  M[30,46] = alpha;
  M[31,2] = gamma;
  M[31,30] = eta;
  M[31,32] = beta;
  M[31,33] = delta;
  M[31,35] = eta;
  M[31,39] = gamma;
  M[31,43] = epsilon;
  M[31,47] = alpha;
  M[32,3] = gamma;
  M[32,30] = gamma;
  M[32,33] = alpha;
  M[32,36] = eta;
  M[32,40] = gamma;
  M[32,44] = epsilon;
  M[32,48] = alpha;
  M[33,4] = gamma;
  M[33,30] = epsilon;
  M[33,31] = delta;
  M[33,32] = alpha;
  M[33,37] = eta;
  M[33,41] = gamma;
  M[33,45] = epsilon;
  M[33,49] = alpha;
  M[34,5] = gamma;
  M[34,30] = eta;
  M[34,35] = eta;
  M[34,36] = gamma;
  M[34,37] = epsilon;
  M[34,38] = beta;
  M[34,42] = delta;
  M[34,50] = alpha;
  M[35,6] = gamma;
  M[35,31] = eta;
  M[35,34] = eta;
  M[35,36] = beta;
  M[35,37] = delta;
  M[35,39] = beta;
  M[35,43] = delta;
  M[35,51] = alpha;
  M[36,7] = gamma;
  M[36,32] = eta;
  M[36,34] = gamma;
  M[36,37] = alpha;
  M[36,40] = beta;
  M[36,44] = delta;
  M[36,52] = alpha;
  M[37,8] = gamma;
  M[37,33] = eta;
  M[37,34] = epsilon;
  M[37,35] = delta;
  M[37,36] = alpha;
  M[37,41] = beta;
  M[37,45] = delta;
  M[37,53] = alpha;
  M[38,9] = gamma;
  M[38,30] = gamma;
  M[38,39] = eta;
  M[38,40] = gamma;
  M[38,41] = epsilon;
  M[38,42] = alpha;
  M[38,54] = alpha;
  M[39,10] = gamma;
  M[39,31] = gamma;
  M[39,38] = eta;
  M[39,40] = beta;
  M[39,41] = delta;
  M[39,43] = alpha;
  M[39,55] = alpha;
  M[40,32] = gamma;
  M[40,38] = gamma;
  M[40,41] = alpha;
  M[40,44] = alpha;
  M[40,56] = alpha;
  M[41,33] = gamma;
  M[41,38] = epsilon;
  M[41,39] = delta;
  M[41,40] = alpha;
  M[41,45] = alpha;
  M[41,57] = alpha;
  M[42,11] = gamma;
  M[42,30] = epsilon;
  M[42,34] = delta;
  M[42,38] = alpha;
  M[42,43] = eta;
  M[42,44] = gamma;
  M[42,45] = epsilon;
  M[42,58] = alpha;
  M[43,12] = gamma;
  M[43,31] = epsilon;
  M[43,35] = delta;
  M[43,39] = alpha;
  M[43,42] = eta;
  M[43,44] = beta;
  M[43,45] = delta;
  M[43,59] = alpha;
  M[44,32] = epsilon;
  M[44,36] = delta;
  M[44,40] = alpha;
  M[44,42] = gamma;
  M[44,45] = alpha;
  M[44,60] = alpha;
  M[45,13] = gamma;
  M[45,33] = epsilon;
  M[45,37] = delta;
  M[45,41] = alpha;
  M[45,42] = epsilon;
  M[45,43] = delta;
  M[45,44] = alpha;
  M[45,61] = alpha;
  M[46,1] = epsilon;
  M[46,14] = delta;
  M[46,30] = alpha;
  M[46,47] = eta;
  M[46,48] = gamma;
  M[46,49] = epsilon;
  M[46,50] = eta;
  M[46,54] = gamma;
  M[46,58] = epsilon;
  M[47,2] = epsilon;
  M[47,15] = delta;
  M[47,31] = alpha;
  M[47,46] = eta;
  M[47,48] = beta;
  M[47,49] = delta;
  M[47,51] = eta;
  M[47,55] = gamma;
  M[47,59] = epsilon;
  M[48,3] = epsilon;
  M[48,16] = delta;
  M[48,32] = alpha;
  M[48,46] = gamma;
  M[48,49] = alpha;
  M[48,52] = eta;
  M[48,56] = gamma;
  M[48,60] = epsilon;
  M[49,4] = epsilon;
  M[49,17] = delta;
  M[49,33] = alpha;
  M[49,46] = epsilon;
  M[49,47] = delta;
  M[49,48] = alpha;
  M[49,53] = eta;
  M[49,57] = gamma;
  M[49,61] = epsilon;
  M[50,5] = epsilon;
  M[50,18] = delta;
  M[50,34] = alpha;
  M[50,46] = eta;
  M[50,51] = eta;
  M[50,52] = gamma;
  M[50,53] = epsilon;
  M[50,54] = beta;
  M[50,58] = delta;
  M[51,6] = epsilon;
  M[51,19] = delta;
  M[51,35] = alpha;
  M[51,47] = eta;
  M[51,50] = eta;
  M[51,52] = beta;
  M[51,53] = delta;
  M[51,55] = beta;
  M[51,59] = delta;
  M[52,7] = epsilon;
  M[52,20] = delta;
  M[52,36] = alpha;
  M[52,48] = eta;
  M[52,50] = gamma;
  M[52,53] = alpha;
  M[52,56] = beta;
  M[52,60] = delta;
  M[53,8] = epsilon;
  M[53,21] = delta;
  M[53,37] = alpha;
  M[53,49] = eta;
  M[53,50] = epsilon;
  M[53,51] = delta;
  M[53,52] = alpha;
  M[53,57] = beta;
  M[53,61] = delta;
  M[54,9] = epsilon;
  M[54,22] = delta;
  M[54,38] = alpha;
  M[54,46] = gamma;
  M[54,55] = eta;
  M[54,56] = gamma;
  M[54,57] = epsilon;
  M[54,58] = alpha;
  M[55,10] = epsilon;
  M[55,23] = delta;
  M[55,39] = alpha;
  M[55,47] = gamma;
  M[55,54] = eta;
  M[55,56] = beta;
  M[55,57] = delta;
  M[55,59] = alpha;
  M[56,24] = delta;
  M[56,40] = alpha;
  M[56,48] = gamma;
  M[56,54] = gamma;
  M[56,57] = alpha;
  M[56,60] = alpha;
  M[57,25] = delta;
  M[57,41] = alpha;
  M[57,49] = gamma;
  M[57,54] = epsilon;
  M[57,55] = delta;
  M[57,56] = alpha;
  M[57,61] = alpha;
  M[58,11] = epsilon;
  M[58,26] = delta;
  M[58,42] = alpha;
  M[58,46] = epsilon;
  M[58,50] = delta;
  M[58,54] = alpha;
  M[58,59] = eta;
  M[58,60] = gamma;
  M[58,61] = epsilon;
  M[59,12] = epsilon;
  M[59,27] = delta;
  M[59,43] = alpha;
  M[59,47] = epsilon;
  M[59,51] = delta;
  M[59,55] = alpha;
  M[59,58] = eta;
  M[59,60] = beta;
  M[59,61] = delta;
  M[60,28] = delta;
  M[60,44] = alpha;
  M[60,48] = epsilon;
  M[60,52] = delta;
  M[60,56] = alpha;
  M[60,58] = gamma;
  M[60,61] = alpha;
  M[61,13] = epsilon;
  M[61,29] = delta;
  M[61,45] = alpha;
  M[61,49] = epsilon;
  M[61,53] = delta;
  M[61,57] = alpha;
  M[61,58] = epsilon;
  M[61,59] = delta;
  M[61,60] = alpha;
  
  M = ((M * pimat)' * pimat)';
  
  for(i in 1:61) {
    M[i, i] = -dot_product(M[i, ], pimult[i, ]);
  }
  
  return(M);
}